load spatial;

create temp table blocks as from st_read('SRCS_Census_Blocks.geojson');

create temp table fixed as
from blocks where GEOID20 not in ('060971521002009', '060971521002016', '060971530011000', '060971523002002')
union
-- PTES/HVES
from blocks 
select 
    * exclude (geom),
    st_intersection(geom, ST_GeomFromText('POLYGON ((-122.69698423569675 38.458102618967814 , -122.70117489264922 38.457487595175024 , -122.70189293111403 38.45784000564825 , -122.70332900804391 38.456497668906735 , -122.69746334171083 38.45498107551768 , -122.69698423569675 38.458102618967814))')) as geom
where GEOID20 in ('060971523002002')
union
from blocks 
select 
    * exclude (geom),
    st_difference(geom, ST_GeomFromText('POLYGON ((-122.69698423569675 38.458102618967814 , -122.70117489264922 38.457487595175024 , -122.70189293111403 38.45784000564825 , -122.70332900804391 38.456497668906735 , -122.69746334171083 38.45498107551768 , -122.69698423569675 38.458102618967814))')) as geom
where GEOID20 in ('060971523002002')
union
-- 101 at SRHS
from blocks 
select 
    * exclude (geom),
    st_intersection(geom, ST_GeomFromText('POLYGON ((-122.72487549455295 38.456252665211 , -122.72769598644176 38.455784723030575 , -122.72857469307854 38.45069757065477 , -122.72825314017419 38.44190925951574 , -122.71465788343738 38.441314884592515 , -122.72268384389584 38.455347632081754 , -122.72487549455295 38.456252665211))')) as geom
where GEOID20 in ('060971521002009', '060971521002016', '060971530011000')
union
from blocks 
select 
    * exclude (geom),
    st_difference(geom, ST_GeomFromText('POLYGON ((-122.72487549455295 38.456252665211 , -122.72769598644176 38.455784723030575 , -122.72857469307854 38.45069757065477 , -122.72825314017419 38.44190925951574 , -122.71465788343738 38.441314884592515 , -122.72268384389584 38.455347632081754 , -122.72487549455295 38.456252665211))')) as geom
where GEOID20 in ('060971521002009', '060971521002016', '060971530011000')
;

copy fixed to 'SRCS_Census_Blocks_Fixed.geojson' (format GDAL, driver 'GeoJSON');